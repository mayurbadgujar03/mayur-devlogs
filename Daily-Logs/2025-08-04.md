# Dev Log: Monday, August 4, 2025

## Summary

In a single, extended work session, I completed the **entire end-to-end migration** of the **Expenso** application from MongoDB/Mongoose to a more robust **PostgreSQL/Prisma** stack. This was a monumental refactor that involved initializing a new database, redesigning the data schema from scratch, systematically rewriting every controller, and finally, cleaning up all legacy code. The application is now fully running on the new, more scalable foundation.

---

## Key Activities & Accomplishments ‚ú®

### 1. Database Initialization & Schema Design

* Initialized Prisma with a PostgreSQL datasource and configured the new database connection within the `Expenso` project.
* Designed and implemented a complete relational schema in `schema.prisma`, defining the `User`, `Item`, and `Purchase` models and their relationships.
* Successfully ran the initial database migration to generate the new tables in PostgreSQL.

### 2. Full Application Logic Refactor

* Systematically refactored **every single controller** to use the new Prisma Client, replacing all Mongoose calls.
* **Auth Controllers:** Migrated `registerUser` and `loginUser`.
* **Core Feature Controllers:** Migrated `createItem`, `dashboard`, `confirmPurchase`, `deleteItem`, `updatePrice`, `history`, and `profile`.
* **Improvements:** Implemented soft-delete functionality for items during the refactor.

### 3. Finalization and Cleanup

* After refactoring all controllers, I performed the final cleanup step.
* **Removed all legacy Mongoose models** and the old MongoDB database connection code, leaving the codebase clean and fully committed to the new stack.

---

## Git Commits commits

* `chore: Initialized Prisma with PostgreSQL datasource and added DB config`
* `feat: Added User model to Prisma schema and ran migration`
* `feat: Added Purchase model with relations to User and Item`
* `feat: Added Item model and relation to User; flattened image object`
* `feat: Completed Prisma schema setup with User, Item, and Purchase models`
* `refactor: Refactored registerUser controller to use Prisma and PostgreSQL`
* `refactor: Refactored loginUser controller to use Prisma client`
* `docs: Kept logoutUser unchanged ‚Äî no DB interaction required`
* `refactor: Converted createItem controller to use Prisma and PostgreSQL`
* `refactor: Converted dashboard controller to Prisma and optimized totals`
* `refactor: Refactored confirm purchase controller to use Prisma`
* `refactor: Converted deleteItem & updatePrice controller to use Prisma with soft delete`
* `refactor: Refactored history & profile controller to use Prisma and include item details`
* `chore: Removed Mongoose models and connection after full Prisma migration`

---

## Plan for Tomorrow (Tuesday, August 5th) üóìÔ∏è

* **Priority 1: Regression Testing.** Thoroughly test all API endpoints using Postman/Insomnia to ensure the migration was 100% successful and introduced no bugs.
* **Priority 2: Plan Next Feature.** Begin architecting the new advanced authentication system (Access/Refresh tokens) on top of this new Prisma foundation.
* **Code Review:** Review the codebase for any necessary documentation updates (JSDoc, comments) following the refactor.